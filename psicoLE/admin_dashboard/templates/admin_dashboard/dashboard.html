{% extends "base.html" %}
{% from "_breadcrumbs.html" import render_breadcrumbs %}

{% block title %}{{ title }} - PsicoLE{% endblock %}

{% block content %}
{{ render_breadcrumbs([{'text': 'Admin Dashboard'}]) }}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="h3"><i class="fas fa-tachometer-alt me-2"></i>{{ title }}</h2>
        <span class="text-muted">Welcome, {{ current_user.username }}!</span>
    </div>

    <!-- Key Statistics -->
    <div class="row g-4 mb-4">
        <div class="col-md-6 col-lg-3">
            <div class="card shadow-sm text-center h-100">
                <div class="card-body">
                    <div class="display-4 text-primary"><i class="fas fa-users"></i></div>
                    <h5 class="card-title mt-3">{{ stats.active_professionals }}</h5>
                    <p class="card-text">Active Professionals</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card shadow-sm text-center h-100">
                <div class="card-body">
                    <div class="display-4 text-warning"><i class="fas fa-file-invoice-dollar"></i></div>
                    <h5 class="card-title mt-3">{{ stats.pending_fees_count }}</h5>
                    <p class="card-text">Pending Fees</p>
                    <small class="text-muted">Total: ${{ "%.2f"|format(stats.total_pending_amount) }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card shadow-sm text-center h-100">
                <div class="card-body">
                    <div class="display-4 text-success"><i class="fas fa-hand-holding-usd"></i></div>
                    <h5 class="card-title mt-3">{{ stats.payments_today_count }}</h5>
                    <p class="card-text">Payments Received Today</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card shadow-sm text-center h-100">
                <div class="card-body">
                    <div class="display-4 text-danger"><i class="fas fa-user-edit"></i></div>
                    <h5 class="card-title mt-3">{{ stats.pending_data_changes }}</h5>
                    <p class="card-text">Pending Data Changes</p>
                    {% if stats.pending_data_changes > 0 %}
                    <a href="{{ url_for('admin_dashboard.list_pending_data_changes') }}" class="btn btn-sm btn-outline-danger mt-1">Review Now</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <hr class="my-4">

    <!-- Quick Links -->
    <h3 class="mb-3"><i class="fas fa-link me-2"></i>Quick Access</h3>
    <div class="row g-3">
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                    <a href="{{ url_for('profesionales.list_professionals') }}" class="btn btn-outline-primary btn-lg"><i class="fas fa-users-cog me-2"></i>Manage Professionals</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                    <a href="{{ url_for('cobranzas.generate_fees_view') }}" class="btn btn-outline-warning btn-lg"><i class="fas fa-cogs me-2"></i>Generate Monthly Fees</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                    <a href="{{ url_for('cobranzas.list_fees') }}" class="btn btn-outline-info btn-lg"><i class="fas fa-list-alt me-2"></i>View Fee Payments</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                    <a href="{{ url_for('facturacion.create_standalone_invoice') }}" class="btn btn-outline-success btn-lg"><i class="fas fa-receipt me-2"></i>Create Invoice</a>
                </div>
            </div>
        </div>
         <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                     <a href="{{ url_for('admin_dashboard.list_pending_data_changes') }}" class="btn btn-outline-danger btn-lg">
                        <i class="fas fa-user-edit me-2"></i>Review Data Changes
                        {% if stats.pending_data_changes > 0 %}<span class="badge bg-danger ms-2">{{ stats.pending_data_changes }}</span>{% endif %}
                    </a>
                </div>
            </div>
        </div>
        {% if current_user.role.name == 'admin' %}
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                    <a href="{{ url_for('configuraciones.list_configurations') }}" class="btn btn-outline-secondary btn-lg"><i class="fas fa-sliders-h me-2"></i>System Configurations</a>
                </div>
            </div>
        </div>
        {% endif %}
        {# Placeholder for Manage Users #}
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-grid">
                    <a href="#" class="btn btn-outline-dark btn-lg disabled"><i class="fas fa-users-slash me-2"></i>Manage Users (Future)</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
